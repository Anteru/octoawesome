#version 130


in vec4 psColor;
in vec2 psTexCoord;
uniform sampler2D text;

uniform sampler2D ShadowMap;
in vec4 shadowPosition;

void main()
{

    float lighted = 1.0f;
    float bias = 0.00007;
    if (shadowPosition.x >-1 && shadowPosition.x <1 &&  
        shadowPosition.y > -1 && shadowPosition.y <1 && 
        texture( ShadowMap, shadowPosition.xy ).z  <  shadowPosition.z- bias){
        lighted = 0.5;
    }

    gl_FragColor = vec4(lighted,lighted,lighted,1.0);
    
    gl_FragColor = gl_FragColor * texture2D(text,psTexCoord);
}
